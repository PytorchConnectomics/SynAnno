{% extends "templatebase.html" %}

{% block help_content %}
<p class="text-muted">This tool aims to help to annotate large datasets. To start, load the .h5 file of the original and
  ground truth data. If you have a previous json file exported by this tool, you can load it too</p>
{% endblock %}

{% block content %}

<script src="https://cdn.socket.io/4.4.1/socket.io.min.js"
  integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H" crossorigin="anonymous"></script>


<div class="px-4 py-3 my-3 text-center">
  <h2 class="mb-3"> Welcome to SynAnno Annotation Tool</h2>
  <p>Select some data and start proofreading!</p>
</div>

<div class="mb-3">
  <form method="POST" for="{{ modeform }}" action="{{ url_for('upload_file') }}" enctype="multipart/form-data">
    <label for="formFileMultiple" class="form-label">Original .h5 data next.</label>
    <p><input class="form-control" type="file" id="originalFile" name="file_original"></p>
    <label for="formFileMultiple" class="form-label">Ground Truth .h5 data next.</label>
    <p><input class="form-control" type="file" id="gtFile" name="file_gt"></p>
    <label for="formFileMultiple" class="form-label">add a JSON file previously exported by this tool.</label>
    <p><input class="form-control" type="file" id="formFile" name="file_json"></p>
    <label for="formGroupExampleInput" class="form-label">Patch Size (square)</label>
    <p><input type="text" class="form-control" id="patchsize" placeholder="142" name="patchsize"></p>
    <p class="mt-4">
      <input id="processData" type="submit" class="btn btn-secondary {{ modecurrent }}" value="Submit">
      <a type="button" class="btn btn-primary {{ modenext }}" href="{{ url_for('set_data', data_name=filename) }}">Start
        data proofread</a>
      <a type="button" id='resetButton' class="btn btn-primary d-{{ modereset or 'none'}}"
        href="{{ url_for('reset') }}">Reset Backend</a>
    </p>
  </form>
</div>

<!-- Modal with progress bar -->
<div class="modal fade" id="progressModal" tabindex="-1" data-bs-backdrop="static" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body">
        <div class="spinner d-flex flex-column align-items-center justify-content-center">
          <div class="row">
            <div class="spinner-border" role="status">
              <span class="sr-only">Loading...</span>
            </div>
          </div>
          <div class="row" id="spinnerText">
            <strong>Loading Source File</strong>
          </div>
        </div>
        <div class="progress d-none">
          <div id="progressBarProcess" class="progress-bar progress-bar-striped progress-bar-animated"
            role="progressbar" aria-valuenow="0 " aria-valuemin="0" aria-valuemax="94"></div>
          <div class="progress-bar-title" id="progressBarText"> </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Script to update the progress bar -->
<script src="{{ url_for('static', filename='progressbar.js') }}"></script>
<!-- add js file to disable the form on reset -->
<script src="{{ url_for('static', filename='opendata.js') }}"></script>

{% endblock %}