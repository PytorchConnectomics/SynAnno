{% extends "templatebase.html" %}

{% block content %}
<div class="container-fluid content-row mb-5 ">

    <p style="text-align: justify;">
        This tool aims to help to annotate large datasets. The annotation is based on labels: right (green), wrong
        (red) and unsure (white). One-click, you label the data as wrong (red color), one more click you label as unsure
        (white), one more click, and the data is labeled as right again (green). At the end of the process, you can
        download a JSON file containing your final labels. If you want to proofread the labels, you can use this file to
        check your previous results.</p>

    <p style="font-weight: 600;">Note: Right-click to enlarge the patch and navigate surrounding slices.</p>

    <div class="legend">
        <strong>Legend:</strong>
        <div class="legend-item"><span class="color-block" style="background-color: #abebc6;"></span>Right</div>
        <div class="legend-item"><span class="color-block" style="background-color: #f08080;"></span>Wrong</div>
        <div class="legend-item"><span class="color-block"
                style="background-color: #d7dbdd;border: 1px solid;"></span>Unsure</div>
    </div>
    <div class="row justify-content-start card-group">
        {% for image in images %}
        <div class="annotate-item mb-3">
            <div id="id{{loop.index}}"
                class="card border-0 p-2 {% if image.Label == 'Correct' %}correct{% elif image.Label == 'Incorrect'%}incorrect{% elif image.Label == 'Unsure'%}unsure{% endif %}">
                <div id="main-image" style="position: relative;">
                    <img id="imgEM-GT-{{loop.index}}" class="img_annotate" src="{{ image.GT ~ '/' ~ image.Middle_Slice ~ '.png'}}"
                        width="64px" height="64px" style="position: absolute; opacity: 0.5; ">
                    <img id="imgGT-{{loop.index}}" class="img_annotate" src="{{ image.EM ~ '/' ~ image.Middle_Slice ~ '.png'}}" width="64px"
                        height="64px" style="position: initial;">
                </div>
                <a id="id-a-{{loop.index}}" class="stretched-link image-card-btn" page="{{page}}"
                    data_id="{{ loop.index }}"
                    label="{% if image.Label == 'Correct' %}Correct{% elif image.Label == 'Incorrect'%}Incorrect{% elif image.Label == 'Unsure'%}Unsure{% endif %}"></a>
            </div>
            <span>{{image.Adjusted_Bbox[1] - image.Adjusted_Bbox[0] + 1 }} slices</span>
        </div>
        {% endfor %}
    </div>
</div>
<nav aria-label="Page navigation mt-4">
    <ul class="pagination justify-content-center">
        {% if page > 0 %}
        <li class="page-item"><a class="page-link" href="{{ url_for('annotation', page=page-1) }}">
                < Previous</a>
        </li>
        {% else %}
        <li class="page-item disabled"><a class="page-link " href="#">
                < Previous</a>
        </li>
        {% endif %}
        <li style="padding: .375rem .75rem;">{{page+1}} / {{n_pages}} </li>
        {% if page+1 < n_pages %} <li class="page-item"><a class="page-link" href="{{ url_for('annotation',
                page=page+1)}}" >Next ></a></li>
            {% else %}
            <li class="page-item disabled"><a class="page-link" href="#">Next ></a></li>
            <li class="page-item"><a class="page-link" href="{{ url_for('categorize') }}">Error Processing</a></li>
            {% endif %}
    </ul>
</nav>


<!-- Modal for synapse slice-->
{% include "annotation_single.html" %}

<!-- Modal for neuroglancer slice-->
{% include "annotation_neuro.html" %}



<!-- add js file to chang the card colors -->
<script src="{{ url_for('static', filename='app.js') }}"></script>
{% endblock %}